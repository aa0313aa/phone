<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>문의 / 상담예약 | 전국모바일</title>
  <meta name="description" content="휴대폰 개통 · 매입 · 상담 예약 페이지입니다. 최소 정보로 빠른 상담 신청 가능.">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
  <link href="assets/css/styles.css" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-expand-lg bg-body shadow-sm sticky-top" aria-label="주요 내비게이션">
  <div class="container">
    <a class="navbar-brand fw-bold" href="index.html"><img src="assets/img/favicon.svg" alt="전국모바일" width="28" height="28" class="me-2">전국모바일</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav" aria-controls="nav" aria-expanded="false" aria-label="내비게이션 토글"><span class="navbar-toggler-icon"></span></button>
    <div class="collapse navbar-collapse" id="nav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="index.html">홈</a></li>
        <li class="nav-item"><a class="nav-link" href="services.html">서비스</a></li>
        <li class="nav-item"><a class="nav-link" href="information.html">이용안내</a></li>
        <li class="nav-item"><a class="nav-link" href="about.html">회사소개</a></li>
        <li class="nav-item"><a class="nav-link active" href="contact.html">문의/예약</a></li>
      </ul>
    </div>
  </div>
</nav>
<header class="py-5 bg-primary text-white">
  <div class="container">
    <h1 class="h2 fw-bold">문의 / 상담예약</h1>
    <p class="text-white-50 mb-0">필수 항목만 입력하면 빠르게 상담 도와드립니다.</p>
  </div>
</header>
<main class="py-5"><div class="container"><div class="row g-5">
<div class="col-lg-7">
<form class="needs-validation" novalidate id="contactForm" method="POST" action="https://script.google.com/macros/s/AKfycbwyoFNrN7g75G6flUzmQjLeydJHLqlw4bsicYdslrhPhrVvr_68C59ymhyTGxfKtJV_DA/exec">
  <div class="alert alert-info small" role="alert"><i class="bi bi-info-circle me-1"></i> 아래 정보만으로 상담 조건 안내 및 혜택 비교가 가능합니다. 민감정보(주민번호 등)는 절대 입력하지 마세요.</div>
  <div class="mb-3"><label class="form-label" for="name">이름</label><input class="form-control" id="name" name="이름" required><div class="invalid-feedback">이름을 입력해주세요.</div></div>
  <div class="mb-3"><label class="form-label" for="phone">연락처</label><input class="form-control" id="phone" name="연락처" type="tel" pattern="^[0-9\-]{9,13}$" required><div class="form-text">숫자와 '-'만 입력 (예: 010-1234-5678)</div><div class="invalid-feedback">올바른 연락처를 입력해주세요.</div></div>
  <div class="mb-3"><label class="form-label" for="type">문의 유형</label><select class="form-select" id="type" name="문의유형" required><option value="" disabled selected>선택해주세요</option><option>비대면 개통</option><option>매장 방문</option><option>휴대폰 매입</option><option>일반 상담</option></select><div class="invalid-feedback">문의 유형을 선택해주세요.</div></div>
  <div class="mb-3"><label class="form-label" for="carrier">통신사</label><select class="form-select" id="carrier" name="통신사"><option value="" selected>선택(선택사항)</option><option>SKT</option><option>KT</option><option>LGU+</option><option>알뜰 / MVNO</option></select></div>
  <div class="mb-3"><label class="form-label" for="recentActive">최근개통일</label><input class="form-control" id="recentActive" name="최근개통일" type="date" max="9999-12-31"><div class="form-text">최근 회선/기기 개통일 (선택)</div></div>
  <div class="mb-3"><label class="form-label" for="arrears">미납연체</label><select class="form-select" id="arrears" name="미납연체"><option value="" selected>선택(선택사항)</option><option>없음</option><option>요금 미납</option><option>연체 우려</option></select></div>
  <div class="mb-3"><label class="form-label" for="region">지역</label><input class="form-control" id="region" name="지역" placeholder="예) 서울 강남 / 부산 해운대 등"></div>
  <div class="mb-3"><label class="form-label" for="desired">희망진행방식</label><select class="form-select" id="desired" name="희망진행방식"><option value="" selected>선택(선택사항)</option><option>비대면 개통</option><option>매장 방문</option><option>택배 / 퀵</option></select></div>
  <div class="mb-3"><label class="form-label" for="message">상세내용</label><textarea class="form-control" id="message" name="상세내용" rows="5" placeholder="예) 아이폰15 기변 조건 문의" required></textarea><div class="invalid-feedback">상세내용을 입력해주세요.</div></div>
  <div class="mb-3 form-check"><input class="form-check-input" type="checkbox" id="agree" required><label class="form-check-label" for="agree">개인정보 수집 및 이용에 동의합니다.</label><div class="invalid-feedback">동의가 필요합니다.</div></div>
  <div class="text-center">
    <button type="submit" class="btn btn-primary btn-lg"><i class="bi bi-send me-2"></i>상담 신청하기</button>
  </div>
  <div id="formResult" class="mt-3 small"></div>
</form>
<!-- Google Form ?�동 ?�출???��? iframe -->
<iframe name="hidden_iframe" id="hidden_iframe" style="display:none;" onload="if(submitted) { handleFormSuccess(); }"></iframe>
<!-- ?�메???�출???��? ??(FormSubmit) -->
<form id="hiddenEmailForm" action="https://formsubmit.co/YOUR_EMAIL@example.com" method="POST" target="_blank" class="d-none">
  <input type="hidden" name="_subject" value="?�국모바???�담 ?�약" />
  <input type="hidden" name="_captcha" value="false" />
  <input type="hidden" name="_template" value="table" />
  <input type="hidden" name="?�름" id="email_name" />
  <input type="hidden" name="?�락�? id="email_phone" />
  <input type="hidden" name="?�형" id="email_type" />
  <input type="hidden" name="?�용" id="email_message" />
  <input type="hidden" name="?�출?�각" id="email_time" />
  <!-- ?�요 ???�래�??�공 ???�동??주소
  <input type="hidden" name="_next" value="https://yourdomain.com/thanks.html" /> -->
  <!-- ?�팸 방�? ?�니??-->
  <input type="text" name="_honey" style="display:none" />
</form>
</div>
<div class="col-lg-5">
  <div class="p-4 bg-body-tertiary border rounded-3 h-100">
    <h2 class="h5">직접 연락</h2>
    <p class="small mb-1"><i class="bi bi-telephone me-1"></i>전화: <a href="tel:010-8290-9536">010-8290-9536</a></p>
    <p class="small mb-1"><i class="bi bi-chat-dots me-1"></i>카카오톡: <a href="http://pf.kakao.com/_gIKxnn/chat" target="_blank" rel="noopener">바로가기</a> <span class="badge text-bg-warning text-dark ms-1">ID: k090912k</span></p>
    <p class="small mb-3"><i class="bi bi-envelope me-1"></i>이메일: info@example.com</p>
    <hr>
    <h3 class="h6 text-secondary">유의 사항</h3>
    <ul class="small mb-0">
      <li>실제 예약 확정은 상담원의 확인 후 진행됩니다.</li>
      <li>민감 정보(계정 비밀번호 등)는 입력하지 마세요.</li>
      <li>매우 급한 문의는 전화 이용을 권장합니다.</li>
    </ul>
  </div>
</div>
</div></div></main>
<footer class="py-4 bg-dark text-light">
  <div class="container small d-flex justify-content-between flex-wrap gap-3">
    <span>© 2025 전국모바일</span>
    <a class="link-light text-decoration-none" href="#top" id="backToTop">맨위로</a>
  </div>
</footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script><script src="assets/js/main.js"></script><script>/* ?�담 ?�약 ?�영 강화 + ?�장 ?�드 ?�??+ ?�약 리스???�더�?*/
(() => {
  const form = document.getElementById('contactForm');
  const result = document.getElementById('formResult');
  const kakaoLink = 'http://pf.kakao.com/_gIKxnn/chat';
  const emailBtn = document.getElementById('emailSubmit');
  const emailForm = document.getElementById('hiddenEmailForm');
  const reservationsContainerId = 'reservationsTableContainer';
  if (!form) return;

  // ?�전??�??�근 ?�퍼
  const fv = (sel) => (form.querySelector(sel)?.value || '').trim();

  // ?�니??�??��?) ?��? ?�드 추�?
  const honeypot = document.createElement('input');
  honeypot.type = 'text'; honeypot.name = 'website'; honeypot.autocomplete = 'off';
  honeypot.style.position = 'absolute'; honeypot.style.left = '-9999px'; honeypot.tabIndex = -1;
  form.appendChild(honeypot);

  // 최근 ?�출 로컬 ?�???�시 ?�역
  const recentBox = document.createElement('div');
  recentBox.className = 'mt-4 small';
  recentBox.innerHTML = '<strong>최근 ?�출(로컬 ?�??:</strong><div id="recentSubmissions" class="mt-2 d-flex flex-column gap-1"></div>';
  form.parentElement?.appendChild(recentBox);

  function renderRecent(){
    const listEl = document.getElementById('recentSubmissions');
    if(!listEl) return;
    const items = JSON.parse(localStorage.getItem('recentReservations')||'[]');
    listEl.innerHTML = items.map(i => `<div class="border rounded p-2 bg-body-tertiary">${i.time} · ${i.name} / ${i.type}<br><span class="text-secondary">${i.phone}</span></div>`).join('');
  }
  renderRecent();

  form.addEventListener('submit', async (e) => {
    e.preventDefault(); // 기본 ?�출 막기
    
    // ?�효??검??
    if (!form.checkValidity()) {
      form.classList.add('was-validated');
      result.innerHTML = '<span class="text-danger">?�력값을 ?�인?�주?�요.</span>';
      return;
    }
    if (honeypot.value) { // �??�심
      result.innerHTML = '<span class="text-warning">?�출??차단?�었?�니??(?�팸 ?�심).</span>';
      return;
    }

    // ?�출 �?메시지 ?�시
    result.innerHTML = '<span class="text-info"><i class="bi bi-hourglass-split"></i> ?�담 ?�청???�송?�는 �?..</span>';

    try {
      // FormData�????�이???�집
      const formData = new FormData(form);
      
      // Google Apps Script�??�송
      const response = await fetch(form.action, {
        method: 'POST',
        body: formData
      });

      const data = await response.json();

      if (data.result === 'success') {
        // ?�공 메시지 ?�시
        result.innerHTML = '<div class="alert alert-success"><i class="bi bi-check-circle-fill me-2"></i><strong>?�담 ?�청???�료?�었?�니??</strong><br>빠른 ?�일 ?�에 ?�락?�리겠습?�다.</div>';
        
        // 로컬 ?�??(최근 5�??��?)
        const localData = {
          name: fv('#name'),
          phone: fv('#phone'),
          type: fv('#type'),
          region: fv('#region'),
          submittedAt: new Date().toLocaleString()
        };
        
        const arr = JSON.parse(localStorage.getItem('recentReservations')||'[]');
        arr.unshift({ time: localData.submittedAt, name: localData.name, phone: localData.phone, type: localData.type, region: localData.region });
        localStorage.setItem('recentReservations', JSON.stringify(arr.slice(0,5)));
        renderRecent();
        
        // ??초기??
        form.reset();
        form.classList.remove('was-validated');
      } else {
        result.innerHTML = '<div class="alert alert-warning"><i class="bi bi-exclamation-triangle-fill me-2"></i>?�출 �??�류가 발생?�습?�다. ?�시 ?�도?�주?�요.</div>';
      }
    } catch (error) {
      console.error('?�출 ?�류:', error);
      result.innerHTML = '<div class="alert alert-danger"><i class="bi bi-x-circle-fill me-2"></i>?�트?�크 ?�류가 발생?�습?�다. ?�시 ???�시 ?�도?�주?�요.</div>';
    }
  });

  // ?�메?�로 ?�수 (FormSubmit ?�출)
  emailBtn?.addEventListener('click', (e) => {
    e.preventDefault();
    if (!form.checkValidity()) {
      form.classList.add('was-validated');
      result.innerHTML = '<span class="text-danger">?�력값을 ?�인?�주?�요.</span>';
      return;
    }
    if (!emailForm) return;

    const action = emailForm.getAttribute('action') || '';
    if (action.includes('YOUR_EMAIL')) {
      result.innerHTML = '<span class="text-warning">관리자 ?�정 ?�요: contact.html ???��? ?�의 ?�신 ?�메?�을 ?�제 주소�?바꿔주세??</span>';
      return;
    }

    const submittedAt = new Date().toLocaleString();
  document.getElementById('email_name').value = fv('#name');
  document.getElementById('email_phone').value = fv('#phone');
  document.getElementById('email_type').value = fv('#type');
  document.getElementById('email_message').value = fv('#message');
    document.getElementById('email_time').value = submittedAt;

    emailForm.submit();
    result.innerHTML = '<span class="text-success">?�메???�출 창이 ????���??�렸?�니?? ?�료 메시지�??�인?�주?�요.</span>';
    form.reset();
    form.classList.remove('was-validated');
  });
})();
// --- ?�약 리스???�더�?로직 ---
async function fetchBaseReservations(){
  try {
    // ?�시�?Google Sheets CSV가 ?�정?�었?�면 ?�선 ?�용
    const csvUrl = document.querySelector('meta[name="reservations-csv-url"]')?.content?.trim();
    if(csvUrl){
      const badge = document.getElementById('reservationModeBadge');
      if(badge) badge.textContent = '(?�시�?· Sheets)';
      const resCsv = await fetch(csvUrl, { cache: 'no-store' });
      if(resCsv.ok){
        const text = await resCsv.text();
        const parsed = parseCsvReservations(text);
        if(parsed.length) return parsed;
      }
    }
    // 기본 로컬 ?�모 JSON
    const res = await fetch('/assets/data/reservations.json', { cache: 'no-store' });
    if(!res.ok) return [];
    const data = await res.json();
    return Array.isArray(data)?data:[];
  } catch(e){ return []; }
}
function parseCsvReservations(csvText){
  // ?�더 가?? region,datetime,name,phone,method,status
  const lines = csvText.split(/\r?\n/).filter(l=>l.trim().length>0);
  if(lines.length < 2) return [];
  const header = lines[0].split(',').map(h=>h.trim().toLowerCase());
  const idx = h => header.indexOf(h);
  const out = [];
  for(let i=1;i<lines.length;i++){
    const cols = lines[i].split(',');
    if(cols.length < 2) continue;
    out.push({
      region: cols[idx('region')]?.trim()||'',
      datetime: cols[idx('datetime')]?.trim()||'',
      name: cols[idx('name')]?.trim()||'',
      phone: cols[idx('phone')]?.trim()||'',
      method: cols[idx('method')]?.trim()||'',
      status: cols[idx('status')]?.trim()||''
    });
  }
  return out;
}
function maskName(name){
  if(!name) return '';
  if(name.length < 2) return name;
  return name[0] + '*' + name.slice(2);
}
function maskPhone(phone){
  return phone.replace(/(\d{3})\d{2,4}(\d{4})/, '$1-****-$2');
}
function getMergedReservations(base){
  const local = JSON.parse(localStorage.getItem('allReservationsDemo')||'[]');
  return [...local, ...base];
}
function paginate(items, page, perPage){
  const total = items.length;
  const pages = Math.ceil(total/perPage);
  const start = (page-1)*perPage;
  return { page, pages, total, slice: items.slice(start, start+perPage)};
}
async function renderReservations(){
  const wrap = document.getElementById('reservationsTableContainer');
  if(!wrap) return;
  const searchInput = document.getElementById('reservationSearch');
  const pageSelect = document.getElementById('reservationPage');
  const perPage = 8;
  const base = await fetchBaseReservations();
  let merged = getMergedReservations(base);
  const keyword = (searchInput?.value||'').trim();
  if(keyword){
    merged = merged.filter(r => r.name.includes(keyword) || r.region.includes(keyword) || r.method.includes(keyword));
  }
  const currentPage = parseInt(pageSelect?.value||'1',10);
  const {page, pages, slice} = paginate(merged, currentPage, perPage);
  const tbody = wrap.querySelector('tbody');
  tbody.innerHTML = slice.map(r => `<tr><td class="text-nowrap">${r.region||'-'}</td><td>${r.datetime}</td><td>${r.name}</td><td>${r.phone}</td><td>${r.method}</td><td><span class="badge bg-primary">${r.status}</span></td></tr>`).join('');
  // ?�이지 ?�?�트 ?�구??
  if(pageSelect){
    pageSelect.innerHTML = Array.from({length: pages}, (_,i)=>`<option value="${i+1}" ${i+1===page?'selected':''}>${i+1}/${pages}</option>`).join('');
  }
  // �?개수 ?�시
  const totalEl = document.getElementById('reservationTotal');
  if(totalEl){ totalEl.textContent = merged.length.toString(); }
}
document.addEventListener('DOMContentLoaded', () => {
  // ?�약 ?�이�?UI ?�입
  const target = document.querySelector('#contactForm')?.parentElement;
  if(target && !document.getElementById('reservationsTableContainer')){
    const box = document.createElement('div');
    box.className = 'mt-5';
    box.innerHTML = `
  <h2 class="h6 mb-3">최근 ?�수/진행 ?�황 <small id="reservationModeBadge" class="text-secondary">(?�모)</small></h2>
      <div class="d-flex flex-wrap gap-2 mb-2 align-items-center">
        <input id="reservationSearch" class="form-control form-control-sm" style="max-width:200px" placeholder="검??(?�름/지??방식)">
        <select id="reservationPage" class="form-select form-select-sm" style="width:auto"></select>
        <span class="small text-secondary">�?<span id="reservationTotal">0</span>�?/span>
        <button id="reservationRefresh" class="btn btn-sm btn-outline-secondary">?�로고침</button>
      </div>
      <div class="table-responsive">
        <table class="table table-sm table-hover align-middle mb-0">
          <thead class="table-light">
            <tr><th>지??/th><th>?�간</th><th>?�름</th><th>?�락�?/th><th>방식</th><th>?�태</th></tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <div class="form-text mt-2">* ?�제 ?�이?��? ?�닌 ?�시 + 브라?��? ?�??기반 ?�모?�니??</div>
    `;
    box.id = 'reservationsTableContainer';
    target.appendChild(box);
    const searchInput = box.querySelector('#reservationSearch');
    const pageSelect = box.querySelector('#reservationPage');
    const refreshBtn = box.querySelector('#reservationRefresh');
    searchInput.addEventListener('input', () => { pageSelect.value = '1'; renderReservations(); });
    pageSelect.addEventListener('change', () => renderReservations());
    refreshBtn.addEventListener('click', () => renderReservations());
    renderReservations();
  }
});
</script>
<!-- Floating Kakao chat shortcut -->
<div class="floating-chat" aria-label="카카?�톡 ?�담 바로가�?>
  <a href="http://pf.kakao.com/_gIKxnn/chat" target="_blank" rel="noopener">
    <i class="bi bi-chat-dots-fill"></i><span>카톡 ?�담</span>
  </a>
</div>
</body></html>
